{
  "pattern_name": "{{ pattern.name }}",
  "nodes": [
    {% for step in pattern.steps %}
    {
      "id": "{{ step.id }}",
      "type": "{{ step.type }}",
      "agent": "{{ step.agent }}",
      "tools": [
        {% for tool in step.tools %}
        "{{ tool }}"{% if not loop.last %},{% endif %}
        {% endfor %}
      ]
    }{% if not loop.last %},{% endif %}
    {% endfor %}
  ],
  "edges": [
    {% for step in pattern.steps %}
      {% for next_id in step.next %}
      {
        "from": "{{ step.id }}",
        "to": "{{ next_id }}"
      }{% if not (loop.last and loop.parent.last) %},{% endif %}
      {% endfor %}
    {% endfor %}
  ]
}